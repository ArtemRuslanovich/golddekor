{% extends "catalog/base.html" %}
{% load static %}

{% block title %}–ö–æ—Ä–∑–∏–Ω–∞ - GoldDecor{% endblock %}

{% block content %}

<h1 class="page-title">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>

{% if cart %}
<section class="cart-container">

    <div class="cart-list">
        {% for item in cart %}
        <div class="cart-item">
            <div class="cart-item-info">
                <img src="{% if item.product.image %}{{ item.product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}"
                    alt="{{ item.product.name }}" class="cart-item-image">
                <div>
                    <a href="{{ item.product.get_absolute_url }}" class="cart-item-name">{{ item.product.name }}</a>
                    <div class="cart-item-category">{{ item.product.category.name }}</div>
                </div>
            </div>

            <div class="cart-item-price">
                {{ item.price|floatformat:2 }} —Ä
            </div>

            <div class="cart-item-quantity">
                <form action="{% url 'cart:cart_update' item.product.id %}" method="post" class="cart-quantity-form">
                    {% csrf_token %}
                    <input type="number" name="quantity" value="{{ item.quantity }}" min="1"
                        max="{{ item.product.stock }}" class="quantity-input">
                    <button type="submit" class="btn-outline-primary btn-sm" title="–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">üìù</button>
                </form>
                <small class="text-muted">–º–∞–∫—Å: {{ item.product.stock }} —à—Ç.</small>
            </div>

            <div class="cart-item-total">
                <strong>{{ item.total_price|floatformat:2 }} —Ä</strong>
            </div>

            <div class="cart-item-remove">
                <form action="{% url 'cart:cart_remove' item.product.id %}" method="post"
                    onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å {{ item.product.name }} –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?');">
                    {% csrf_token %}
                    <button type="submit" class="btn-outline-secondary btn-sm" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="cart-summary">
        <p class="cart-total">–ò—Ç–æ–≥–æ: <strong>{{ cart.get_total_price|floatformat:2 }} —Ä</strong></p>

        <div class="cart-actions">
            <a href="{% url 'catalog:product_list' %}" class="btn-outline-secondary">‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>

            <form action="{% url 'cart:clear_cart' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn-outline-secondary">üßπ –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
            </form>

            <a href="#" class="btn">üöÄ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a>
        </div>
    </div>

</section>

{% else %}
<div class="no-products">
    <img src="{% static 'img/no_image.png' %}" alt="–ü—É—Å—Ç–∞—è –∫–æ—Ä–∑–∏–Ω–∞" class="empty-cart-image">
    <h3>üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h3>
    <p>–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑.</p>
    <a href="{% url 'catalog:product_list' %}" class="btn">üõç –ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É</a>
</div>
{% endif %}

{% endblock %}